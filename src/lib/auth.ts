import { NextRequest } from "next/server";`nimport { createServerClient } from "./supabase-server";`n`nexport async function getCurrentUser(request: NextRequest) {`n  const supabase = createServerClient();`n  const { data: { user } } = await supabase.auth.getUser();`n  return user;`n}`n`nexport function requireAuth(handler: Function) {`n  return async (request: NextRequest, ...args: any[]) => {`n    const user = await getCurrentUser(request);`n    if (!user) {`n      return new Response("Unauthorized", { status: 401 });`n    }`n    return handler(request, ...args);`n  };`n}

